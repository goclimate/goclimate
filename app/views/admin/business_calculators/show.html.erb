<p id="notice"><%= notice %></p>

<h1>Business calculator</h1>

<dl class="dl-horizontal">
  <dt>Name:</dt>
  <dd><%= @calculator.name %></dd>

  <dt>Contents:</dt>
  <dd>
    <% BusinessCalculators::CalculatorCategory.where(calculator_id: @calculator.id).each do |category| %>
      <b><%= category.name %></b>
      <ul>
        <% BusinessCalculators::CalculatorField.where(category_id: category.id).each do |field| %>
          <li>
            <%= field.label %>
            <% formatted_unit_names = field.units&.map { |(key, _value)| BusinessCalculators::Unit.where(key: key).first.name }&.join(", ") %>
            (<%= "#{formatted_unit_names}#{formatted_unit_names.present? ? ', free form' : 'Free form'}" %>)
          </li>
        <% end %>
      </ul>
    <% end %>
  </dd>
  
  <dt>Updated:</dt>
  <dd><%= time_tag(@calculator.updated_at) %></dd>
</dl>

<hr>

<%= link_to 'Edit', edit_admin_business_calculator_path(@calculator), class: 'btn btn-default' %>
<%= link_to 'Preview form', preview_reported_data_path(@calculator.id), class: 'btn btn-default', target: :_blank %>
<%= link_to 'Back to all calculators', admin_business_calculators_path, class: 'btn btn-link' %>
