<p id="notice"><%= notice %></p>

<h1>Projects</h1>

<dl>
  <dt>Total CO2</dt><dd><%= @total_co2 %> tonnes</dd>
  <dt>Total spent</dt><dd><%= @total_sek_spent %> SEK</dd>
</dl>

<table class="table">
  <thead>
    <tr>
      <th>Id</th>
      <th>Name</th>
      <th>Carbon offset</th>
      <th>Carbon offset reserved</th>
      <th>Carbon offset left</th>
      <th>Cost in SEK</th>
      <th>Date bought</th>
      <th>Country</th>
      <th>Offset type</th>
      <th>Start block</th>
      <th>End block</th>
      <th></th>
    </tr>
  </thead>

  <tbody>
    <% @projects.each do |project| %>
      <tr>
        <td><%= project.id %></td>
        <td><%= project.name %></td>
        <td><%= project.carbon_offset %></td>
        <td><%= project.invoice.sum(:carbon_offset) %></td>
        <td><%= (project.carbon_offset.presence || 0) - project.invoice.sum(:carbon_offset) %></td>
        <td><%= project.cost_in_sek %></td>
        <td><%= project.date_bought %></td>
        <td><%= project.country %></td>
        <td><%= project.offset_type %></td>
        <td><%= project.start_block %></td>
        <td><%= project.end_block %></td>
        <td class="admin-actions">
          <%= link_to 'Show', [:admin, project] %> &nbsp;
          <%= link_to 'Edit', edit_admin_project_path(project) %> &nbsp;
          <%= link_to 'Destroy', [:admin, project], method: :delete, data: { confirm: 'Are you sure?' } %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<hr>

<%= link_to 'New Project', new_admin_project_path, class: 'btn btn-default' %>
